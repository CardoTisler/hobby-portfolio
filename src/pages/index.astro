---
import { getCollection } from 'astro:content';
import Layout from '@/layouts/Layout.astro';
import Hero from '@/components/Hero.astro';
import ProjectGrid from '@/components/ProjectGrid.astro';
import { sortProjectsByDate } from '@/lib/utils';

const allProjects = await getCollection('projects');
const recentProjects = sortProjectsByDate(allProjects).slice(0, 6);
---

<Layout title="Cardo Tisler â€” Craftsman">
  <Hero />

  <!-- Recent Work Section -->
  <section class="py-24 px-8 lg:px-12 bg-aged/30">
    <div class="max-w-6xl mx-auto">
      <!-- Section header - blueprint style -->
      <div class="blueprint-box p-6 mb-12 bg-paper">
        <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-4">
          <div class="animate-fade-up">
            <div class="tech-label mb-2">Section 01</div>
            <h2 class="font-display text-3xl text-navy">
              Recent Drawings
            </h2>
          </div>

          {allProjects.length > 6 && (
            <a
              href="/gallery"
              class="animate-fade-up delay-100 inline-flex items-center gap-3 text-ink hover:text-navy transition-colors duration-300 group"
            >
              <span class="text-xs font-label tracking-widest uppercase">View Complete Index</span>
              <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </a>
          )}
        </div>
      </div>

      <ProjectGrid
        projects={recentProjects}
        emptyMessage="Projects coming soon."
      />
    </div>
  </section>

  <!-- About section - technical note style -->
  <section class="py-24 px-8 lg:px-12 border-t-2 border-navy">
    <div class="max-w-6xl mx-auto">
      <div class="grid lg:grid-cols-12 gap-12">
        <div class="lg:col-span-8">
          <div class="animate-fade-up blueprint-box p-8 lg:p-12 bg-paper">
            <div class="tech-label mb-6">Technical Note &mdash; TN-001</div>

            <p class="font-display text-2xl sm:text-3xl text-navy leading-relaxed">
              Every project is an exercise in precision.
              In understanding the material.
              In documenting the process.
              In building things that last.
            </p>

            <div class="annotation mt-10 text-faded">
              These drawings represent work completed in Estonia,
              where traditional craftsmanship meets modern documentation.
            </div>
          </div>
        </div>

        <!-- Stats panel -->
        <div class="lg:col-span-4">
          <div class="animate-fade-up delay-200 blueprint-box p-6 bg-aged/50 h-full">
            <div class="tech-label mb-6">Archive Statistics</div>

            <div class="space-y-6">
              <div class="flex items-center justify-between py-3 border-b border-light-ink/30">
                <span class="text-faded text-sm">Total Drawings</span>
                <span class="font-display text-2xl text-navy">{allProjects.length}</span>
              </div>
              <div class="flex items-center justify-between py-3 border-b border-light-ink/30">
                <span class="text-faded text-sm">Categories</span>
                <span class="font-display text-2xl text-navy">3</span>
              </div>
              <div class="flex items-center justify-between py-3 border-b border-light-ink/30">
                <span class="text-faded text-sm">Location</span>
                <span class="text-navy font-medium">Estonia</span>
              </div>
            </div>

            <div class="mt-6 flex justify-end">
              <div class="stamp text-rust border-rust">
                Verified
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>
