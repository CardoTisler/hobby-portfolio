---
import { getCollection } from 'astro:content';
import Layout from '@/layouts/Layout.astro';
import Hero from '@/components/Hero.astro';
import ProjectGrid from '@/components/ProjectGrid.astro';
import { sortProjectsByDate } from '@/lib/utils';

const allProjects = await getCollection('projects');
const recentProjects = sortProjectsByDate(allProjects).slice(0, 6);
---

<Layout title="Cardo Tisler â€” Craftsman">
  <Hero />

  <!-- Recent Work -->
  <section class="py-24 px-8 lg:px-12">
    <div class="max-w-6xl mx-auto">
      <!-- Section header -->
      <div class="flex flex-col sm:flex-row sm:items-end justify-between gap-6 mb-14">
        <div class="animate-fade-up">
          <div class="flex items-center gap-3 mb-3">
            <div class="rivet"></div>
            <span class="workshop-label">Workshop</span>
          </div>
          <h2 class="font-display text-3xl text-bone tracking-wide">
            Recent Work
          </h2>
        </div>

        {allProjects.length > 6 && (
          <a
            href="/gallery"
            class="animate-fade-up delay-100 inline-flex items-center gap-4 text-smoke hover:text-copper transition-colors duration-300 group"
          >
            <span class="text-sm tracking-wide">View all projects</span>
            <span class="w-8 h-0.5 bg-copper group-hover:w-12 transition-all duration-300"></span>
          </a>
        )}
      </div>

      <ProjectGrid
        projects={recentProjects}
        emptyMessage="Projects coming soon."
      />
    </div>
  </section>

  <!-- Philosophy section -->
  <section class="py-24 px-8 lg:px-12 border-t border-walnut">
    <div class="max-w-6xl mx-auto">
      <div class="grid lg:grid-cols-2 gap-16 items-center">
        <!-- Quote -->
        <div class="animate-fade-up">
          <p class="font-display text-3xl sm:text-4xl text-bone leading-relaxed tracking-wide">
            Every project begins at the workbench.
            Shaped by hand. Sanded smooth.
            Built to last generations.
          </p>

          <div class="mt-10 copper-line max-w-xs"></div>
        </div>

        <!-- Stats panel -->
        <div class="animate-fade-up delay-200">
          <div class="hammered-border p-8 bg-timber/50">
            <div class="flex items-center gap-3 mb-6">
              <div class="rivet"></div>
              <div class="rivet"></div>
              <div class="rivet"></div>
              <span class="workshop-label ml-2">Workshop Stats</span>
            </div>

            <div class="grid grid-cols-2 gap-8">
              <div>
                <span class="font-display text-4xl text-copper">{allProjects.length}</span>
                <p class="text-smoke text-sm mt-1">Projects</p>
              </div>
              <div>
                <span class="font-display text-4xl text-copper">3</span>
                <p class="text-smoke text-sm mt-1">Disciplines</p>
              </div>
              <div class="col-span-2">
                <span class="font-display text-2xl text-bone">Estonia</span>
                <p class="text-smoke text-sm mt-1">Workshop Location</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>
